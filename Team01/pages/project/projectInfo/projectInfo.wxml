<!-- Nav bar -->
<van-sticky offset-top="{{ 0 }}">
  <view class="navbar">
    <text wx:for="{{navbar}}" data-idx="{{index}}" class="item {{currentTab==index ? 'active' : ''}}" wx:key="unique" bindtap="navbarTap">{{item}}</text>
  </view>
</van-sticky>

<!-- pop up calendar -->
<van-calendar
  show="{{ show }}"
  title="choose period"
  type="range"
  bind:close="onClose"
  bind:confirm="onConfirm"
/>

<!-- Subpages -->
<!-- Project Information -->

<view wx:if="{{currentTab==0}}">

  <van-cell-group inset title="{{dictionary.project_info}}">
    <van-cell title="{{dictionary.owner}}" value="{{owner}}" />
    <van-cell title="{{dictionary.start_time}}" is-link value="{{startTime}}" bindtap="onDateDisplay" class="projectInfoStartTimeForTest"/>
    <van-cell title="{{dictionary.end_time}}" is-link value="{{endTime}}" bindtap="onDateDisplay" class="projectInfoEndTimeForTest"/>
    <van-field model:value="{{ projectDescription }}" right clearable label="{{dictionary.description}}"
    placeholder="{{projectDescription}}" border="{{ false }}"></van-field>
  </van-cell-group>

  <van-cell-group inset title="{{dictionary.state_information}}">
    <van-cell title="{{dictionary.current_state}}" value="{{currentState}}" />
    <van-field model:value="{{ stateDescription }}" center clearable label="{{dictionary.description}}"
    placeholder="{{stateDescription}}" border="{{ false }}"></van-field>
  </van-cell-group>

  <van-cell-group inset title="{{dictionary.task_progress}}">
  </van-cell-group>
  <view class="container">
    <view class="circle">
      <van-circle value="{{(completed/total)*100}}" layer-color="#eeeeee"         color="#4169E1">
        {{m1.toInteger((completed/total)*100)}}%<view></view>{{dictionary.completed}}
      </van-circle>

      <van-circle value="{{(delayed/total)*100}}" layer-color="#eeeeee" color="#FF4500">
        {{(delayed/total)%1*100}}%<view></view> {{dictionary.delayed}}
      </van-circle>
    </view>
    
    <view class="taskInfo">
      <view class="taskInfoDetail">
        <view style="font-size: 35rpx; color: #696969;">{{unstarted}}</view>
        <view>{{dictionary.unstarted}}</view>
      </view>


      <view class="taskInfoDetail">
        <view style="font-size: 35rpx; color: #FFA500;">{{processing}}</view>
        <view>{{dictionary.processing}}</view>

      </view>

      <view class="taskInfoDetail">
        <view style="font-size: 35rpx; color: 	#FF4500;">{{completed}}</view>
        <view>{{dictionary.completed}}</view>
      </view>

      <view class="taskInfoDetail" style="padding-left: 40rpx ; border-left: 2rpx solid #efefef;">
        <view style="font-size: 35rpx; color: #696969; ">{{total}}</view>
        <view>{{dictionary.total}}</view>
      </view>

      <view class="taskInfoDetail">
        <view style="font-size: 35rpx; color:#FF4500;">{{delayed}}</view>
        <view>{{dictionary.delayed}}</view>
      </view>

    </view>
  </view>


    <wxs module="m1">
      module.exports.toInteger = function(str) {
        return str - str % 1
      }
    </wxs>

    <wxs src="../../../utils/tools.wxs" module="m2"></wxs>

</view>



<!-- Task Management -->
<view wx:elif="{{currentTab==1}}">

  <van-collapse value="{{ activeNames }}" bind:change="onChange">

    <van-collapse-item title="{{dictionary.processing}}" name="1" class="releaseStartedItemForTest">

      <!-- 发起一个请求填充 -->
      <van-cell is-link
        label="start time:{{startTime}}"
        title="单元格"
        link-type="navigateTo"
        url="/pages/project/taskInfo/taskInfo"
      />

      <van-cell is-link id=""
        label="start time:{{startTime}}"
        title="单元格"
        link-type="navigateTo"
        url="/pages/project/taskInfo/taskInfo"
        class="startedTaskForTest"
      />
      
    </van-collapse-item>

    <van-collapse-item title="{{dictionary.unstarted}}" name="2">

    </van-collapse-item>

    <van-collapse-item title="{{dictionary.completed}}" name="3">

    </van-collapse-item>
  </van-collapse>

  <!-- Create new task -->
  <van-sticky offset-top="{{ 600 }}">
    <van-button hairline plain round block type="info" bindtap="clickNewProject">{{dictionary.create_new_task}}</van-button>
  </van-sticky>

</view>



<!-- Gantt Diagram -->
<view wx:else>
  <view class="gantt">
  <ec-canvas id="mychart-dom-graph" canvas-id="mychart-graph" ec="{{ ec }}"></ec-canvas>
</view>
</view>


